<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>SKNF</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.7 -->
    <link rel="stylesheet" href="{% static 'vendor/bootstrap/dist/css/bootstrap.min.css' %}">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="{% static 'vendor/font-awesome/css/font-awesome.min.css' %}">
    <!-- Ionicons -->
    <link rel="stylesheet" href="{% static 'vendor/Ionicons/css/ionicons.min.css' %}">
    <!-- Theme style -->
    <link rel="stylesheet" href="{% static 'vendor/dist/css/AdminLTE.min.css' %}">
    <!-- iCheck -->
    <link rel="stylesheet" href="{% static 'vendor/plugins/iCheck/square/blue.css' %}">

    <link rel="stylesheet" href="{% static 'sknf/css/login.css' %}">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Google Font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin=""/>
</head>
<body  class="hold-transition">
<!--<div class="content">-->
<!--    <div class="row">-->
<!--        <div class="col-md-8">-->
<!--            <div class="box box-primary">-->
<!--                &lt;!&ndash; /.box-header &ndash;&gt;-->
<!--                &lt;!&ndash; form start &ndash;&gt;-->
<!--                <form role="form">-->
<!--                    <div class="box-body">-->
<!--                        <div class="row">-->
<!--                            <div class="col-md-6">-->
<!--                                <div class="form-group">-->
<!--                                    <input type="text" name="name_contains" class="form-control" id="school-name" placeholder="Enter School">-->
<!--                                </div>-->
<!--                            </div>-->
<!--                            <div class="col-md-6">-->
<!--                                <div class="form-group">-->
<!--                                    <input type="email" name="division_contains" class="form-control" id="division-name" placeholder="Enter Division">-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="row">-->
<!--                            <div class="col-md-4">-->
<!--                                <div class="form-group">-->
<!--                                    <input type="email" name="district_contains" class="form-control" id="district-name" placeholder="Enter District">-->
<!--                                </div>-->
<!--                            </div>-->
<!--                            <div class="col-md-4">-->
<!--                                <div class="form-group">-->
<!--                                    <input type="email" name="upazilla_contains" class="form-control" id="upazilla-name" placeholder="Enter Upazilla">-->
<!--                                </div>-->
<!--                            </div>-->
<!--                            <div class="col-md-3">-->
<!--                                <div class="form-group">-->
<!--                                    <input type="email" name="union_contains" class="form-control" id="union-name" placeholder="Enter Union">-->
<!--                                </div>-->
<!--                            </div>-->
<!--                            <div class="col-md-1">-->
<!--                                <div class="form-group">-->
<!--                                    <button type="button" id="school-search" class="btn btn-primary pull-right">Search</button>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    &lt;!&ndash; /.box-body &ndash;&gt;-->
<!--                </form>-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="col-md-4">-->
<!--            &lt;!&ndash; Horizontal Form &ndash;&gt;-->
<!--            <div class="box box-info">-->
<!--                &lt;!&ndash; /.box-header &ndash;&gt;-->
<!--                &lt;!&ndash; form start &ndash;&gt;-->
<!--                <form class="form-horizontal">-->
<!--                    <div class="box-body">-->
<!--                        <div class="form-group">-->

<!--                            <div class="col-sm-6">-->
<!--                                <input type="email" class="form-control" id="inputEmail3" placeholder="Email">-->
<!--                            </div>-->
<!--                            <div class="col-sm-6">-->
<!--                                <input type="password" class="form-control" placeholder="Password">-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    &lt;!&ndash; /.box-body &ndash;&gt;-->
<!--                    <div class="box-footer">-->
<!--                        <button type="submit" class="btn btn-info pull-right">Sign in</button>-->
<!--                    </div>-->
<!--                    &lt;!&ndash; /.box-footer &ndash;&gt;-->
<!--                </form>-->
<!--            </div>-->
<!--            &lt;!&ndash; /.box &ndash;&gt;-->
<!--        </div>-->
<!--    </div>-->
<!--    <div class="row">-->
<!--        <div class="col-md-12" >-->
<!--            <div id="map-result">-->
<!--                <div id="result">-->
<!--                    <table id="search-table" class=" data-table school-table table table-bordered table-striped">-->
<!--                        <thead>-->
<!--                        <tr>-->
<!--                            <th class = "col-sm-4">Name</th>-->
<!--                            <th class ="col-sm-2">EIIN</th>-->
<!--                            <th class ="col-sm-2">Division</th>-->
<!--                            <th class ="col-sm-2">District</th>-->
<!--                            <th class ="col-sm-2">Actions</th>-->
<!--                        </tr>-->
<!--                        </thead>-->
<!--                        <tbody>-->
<!--                        {% include 'accounts/partial_school_list.html' %}-->
<!--                        </tbody></table>-->
<!--                </div>-->
<!--                <div id="map">-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->
<div id="map"></div>
<div id="search-close" onclick="hideSearch();">
    <span class="fa fa-window-minimize"></span>
</div>
<div id="home-logo">
    <div class="container-fluid">
        <div class="row">
            <div id="home-logo-box">
                <div id="logo" >
                    <a href=""><img src="{% static 'sknf/images/logo.png' %}" alt="logo">
                    </a>
                </div>
                <div id="logo-text">
                    <img id="logo-text-size" src="{% static 'sknf/images/sknf-logo-text.png' %}" alt="logo Text">
                </div>
            </div>
        </div>
    </div>
</div>
<div id="search-bar">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="box" id="login-box">
                    <!-- /.box-header -->
                    <!-- form start -->
                    <form class="form-horizontal" method="post">
                        {% csrf_token %}
                        <div class="box-header">
                            <h4>Login</h4>
                        </div>
                        {% if next_destination %}
                        <p class="login-box-msg alert-danger" style="padding: 9px;height: 40px;}">
                            You have to login first to view this page.</p> <br />
                        {% else %}
                        <p class="login-box-msg">Sign in to start your session        </p>
                        {% endif %}
                        <div class="box-body">
                            {% if form.non_field_errors %}
                            {% for error in form.non_field_errors %}
                            <p class="text-danger">{{ error }}</p>
                            {% endfor %}
                            {% endif %}
                            {% if messages %}
                            {% for message in messages %}
                            <p class="text-danger text-center">{{ message }}</p>
                            {% endfor %}
                            {% endif %}
                            <div class="form-group">

                                <div class="col-sm-12">
                                    {{ form.email }}
                                    <span style="right: 20px;" class="glyphicon glyphicon-envelope form-control-feedback"></span>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-12">
                                    {{ form.password }}
                                    <span style="right: 20px;" class="glyphicon glyphicon-lock form-control-feedback"></span>
                                </div>
                            </div>
                            <!-- /.box-body -->
                            <button type="submit" class="btn btn-primary pull-right">Sign in</button>
                        </div>
                    </form>
                </div>
                <!-- /.box -->
            </div>
        </div>
        <div class="row" id="search-school">
            <div class="col-md-12">
                <div class="box box-primary" id="search-box">
                    <!-- /.box-header -->
                    <!-- form start -->
                    <form role="form">
                        <div class="box-header">
                            <h4>Search School</h4>
                        </div>
                        <div class="box-body">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <input type="text" name="name_contains" class="form-control" id="school-name" placeholder="Enter School">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <input type="email" name="division_contains" class="form-control" id="division-name" placeholder="Enter Division">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <input type="email" name="district_contains" class="form-control" id="district-name" placeholder="Enter District">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <input type="email" name="upazilla_contains" class="form-control" id="upazilla-name" placeholder="Enter Upazilla">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <input type="email" name="union_contains" class="form-control" id="union-name" placeholder="Enter Union">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <button type="button" id="school-search" class="btn btn-primary pull-right">Search</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- /.box-body -->
                    </form>
                </div>
            </div>
        </div>

    </div>
</div>
<div id="result">
    <span id="close" class="fa fa-close fa-2x text-red" onclick="hideResult();"></span>
    <div class="container-fluid">
        <h4>Schools</h4>
        <div class="row" style="margin-top: 30px;">
            <div class="col-md-12" >

                <table id="search-table" class=" data-table school-table table table-bordered table-striped">
                    <thead>
                    <tr>
                        <th class = "col-sm-4">Name</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% include 'accounts/partial_school_list.html' %}
                    </tbody>
                </table>

            </div>
        </div>
    </div>
</div>


<!-- jQuery 3 -->
<script src="{% static 'vendor/jquery/dist/jquery.min.js' %}"></script>
<!-- Bootstrap 3.3.7 -->
<script src="{% static 'vendor/bootstrap/dist/js/bootstrap.min.js' %}"></script>
<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin=""></script>
<!-- iCheck -->
<script src="{% static 'vendor/plugins/iCheck/icheck.min.js' %}"></script>
<script>
    $(function () {
        var districts = [
            { name: 'Cumilla', div: 'Chattogram', loc: [23.4607, 91.1809]},
            { name: 'Feni', div: 'Chattogram', loc: [23.0159, 91.3976]},
            { name: 'Brahmanbaria', div: 'Chattogram', loc: [23.9608, 91.1115]},
            { name: 'Rangamati', div: 'Chattogram', loc: [22.7324, 92.2985]},
            { name: 'Noakhali', div: 'Chattogram', loc: [22.8724, 91.0921]},
            { name: 'Chandpur', div: 'Chattogram', loc: [23.2321, 90.6631]},
            { name: 'Lakshmipur', div: 'Chattogram', loc: [22.9447, 90.8282]},
            { name: 'Chattogram', div: 'Chattogram', loc: [22.3419, 91.8155]},
            { name: 'Coxsbazar', div: 'Chattogram', loc: [21.4272, 92.0058]},
            { name: 'Khagrachhari', div: 'Chattogram', loc: [23.1322, 91.9490]},
            { name: 'Bandarban', div: 'Chattogram', loc: [21.8311, 92.3686]},
            { name: 'Sirajganj', div: 'Rajshahi', loc: [24.3141, 89.5700]},
            { name: 'Pabna', div: 'Rajshahi', loc: [24.1585, 89.4481]},
            { name: 'Bogura', div: 'Rajshahi', loc: [24.8481, 89.3730]},
            { name: 'Rajshahi', div: 'Rajshahi', loc: [24.3745, 88.6042]},
            { name: 'Natore', div: 'Rajshahi', loc: [24.4102, 89.0076]},
            { name: 'Joypurhat', div: 'Rajshahi', loc: [25.0947, 89.0945]},
            { name: 'Chapainawabganj', div: 'Rajshahi', loc: [24.7413, 88.2912]},
            { name: 'Naogaon', div: 'Rajshahi', loc: [24.7936, 88.9318]},
            { name: 'Jashore', div: 'Khulna', loc: [23.1778, 89.1801]},
            { name: 'Satkhira', div: 'Khulna', loc: [22.3155, 89.1115]},
            { name: 'Meherpur', div: 'Khulna', loc: [23.8052, 88.6724]},
            { name: 'Narail', div: 'Khulna', loc: [23.1657, 89.4990]},
            { name: 'Chuadanga', div: 'Khulna', loc: [23.6161, 88.8263]},
            { name: 'Kushtia', div: 'Khulna', loc: [23.8907, 89.1099]},
            { name: 'Magura', div: 'Khulna', loc: [23.4290, 89.4364]},
            { name: 'Khulna', div: 'Khulna', loc: [22.8456, 89.5403]},
            { name: 'Bagerhat', div: 'Khulna', loc: [22.6602, 89.7895]},
            { name: 'Jhenaidah', div: 'Khulna', loc: [23.5450, 89.1726]},
            { name: 'Jhalakathi', div: 'Barishal', loc: [22.5721, 90.1870]},
            { name: 'Patuakhali', div: 'Barishal', loc: [22.2249, 90.4548]},
            { name: 'Pirojpur', div: 'Barishal', loc: [22.5791, 89.9759]},
            { name: 'Barishal', div: 'Barishal', loc: [22.7010, 90.3535]},
            { name: 'Bhola', div: 'Barishal', loc: [22.1785, 90.7101]},
            { name: 'Barguna', div: 'Barishal', loc: [22.0953, 90.1121]},
            { name: 'Sylhet', div: 'Sylhet', loc: [22.0953, 90.1121]},
            { name: 'Moulvibazar', div: 'Sylhet', loc: [24.3095, 91.7315]},
            { name: 'Habiganj', div: 'Sylhet', loc: [24.4771, 91.4507]},
            { name: 'Sunamganj', div: 'Sylhet', loc: [25.0667, 91.4072]},
            { name: 'Narsingdi', div: 'Dhaka', loc: [24.1344, 90.7860]},
            { name: 'Gazipur', div: 'Dhaka', loc: [23.9999, 90.4203]},
            { name: 'Shariatpur', div: 'Dhaka', loc: [23.2423, 90.4348]},
            { name: 'Narayanganj', div: 'Dhaka', loc: [23.6238, 90.5000]},
            { name: 'Tangail', div: 'Dhaka', loc: [24.2513, 89.9167]},
            { name: 'Kishoreganj', div: 'Dhaka', loc: [24.4260, 90.9821]},
            { name: 'Manikganj', div: 'Dhaka', loc: [23.8617, 90.0003]},
            { name: 'Dhaka', div: 'Dhaka', loc: [23.8103, 90.4125]},
            { name: 'Munshiganj', div: 'Dhaka', loc: [23.8103, 90.4125]},
            { name: 'Rajbari', div: 'Dhaka', loc: [23.7644, 89.6475]},
            { name: 'Madaripur', div: 'Dhaka', loc: [23.2393, 90.1870]},
            { name: 'Gopalganj', div: 'Dhaka', loc: [23.0488, 89.8879]},
            { name: 'Faridpur', div: 'Dhaka', loc: [23.5424, 89.6309]},
            { name: 'Panchagarh', div: 'Rangpur', loc: [26.2709, 88.5952]},
            { name: 'Dinajpur', div: 'Rangpur', loc: [25.6279, 88.6332]},
            { name: 'Lalmonirhat', div: 'Rangpur', loc: [25.9923, 89.2847]},
            { name: 'Nilphamari', div: 'Rangpur', loc: [25.8483, 88.9414]},
            { name: 'Gaibandha', div: 'Rangpur', loc: [25.3290, 89.5415]},
            { name: 'Thakurgaon', div: 'Rangpur', loc: [26.0418, 88.4283]},
            { name: 'Rangpur', div: 'Rangpur', loc: [25.7439, 89.2752]},
            { name: 'Kurigram', div: 'Rangpur', loc: [25.8072, 89.6295]},
            { name: 'Sherpur', div: 'Mymensingh', loc: [25.0746, 90.1495]},
            { name: 'Mymensingh', div: 'Mymensingh', loc: [24.7471, 90.4203]},
            { name: 'Jamalpur', div: 'Mymensingh', loc: [25.0831, 89.7853]},
            { name: 'Netrokona', div: 'Mymensingh', loc: [24.8103, 90.8656]}
        ];
        var center = [23.5, 90.5];
        var mymap = L.map('map').setView( center, 7);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(mymap);



        for(i = 0; i < districts.length; i++){
            var marker = L.marker(districts[i].loc)
            marker.division = districts[i].div
            marker.district = districts[i].name
            marker.addTo(mymap);
            marker.on('click', function(){
                division_contains = this.division;
                district_contains = this.district;
                $.ajax({
                    type: 'GET',
                    url: '/api/search_school_list/',
                    data: {
                        'division_contains': division_contains,
                        'district_contains': district_contains,
                    },
                    success: function (data) {
                        if (data.form_is_valid) {

                            $("#search-table tbody").html(data.html_school_list);  // <-- Replace the table body
                        }
                        $('#result').show()
                    }
                });
            });
        }
        $('#school-search').on('click', function () {
            name_contains = $('#school-name').val();
            division_contains = $('#division-name').val();
            district_contains = $('#district-name').val();
            upazilla_contains = $('#upazilla-name').val();
            union_contains = $('#union-name').val();
            $.ajax({
                type: 'GET',
                url: '/api/search_school_list/',
                data: {
                    'name_contains': name_contains,
                    'division_contains': division_contains,
                    'district_contains': district_contains,
                    'upazilla_contains': upazilla_contains,
                    'union_contains': union_contains,
                    csrfmiddlewaretoken: '{{ csrf_token }}'
                },
                success: function (data) {
                    if (data.form_is_valid) {

                        $("#search-table tbody").html(data.html_school_list);  // <-- Replace the table body
                    }
                    $('#result').show('slow')
                }
            });
        });
    });
    function hideSearch(){
        if($('#search-close span').hasClass("fa-window-restore")){
            $('#search-close span').removeClass("fa-window-restore").addClass("fa-window-minimize")
            $('#search-bar').show();
        } else {
            $('#search-close span').removeClass("fa-window-minimize").addClass("fa-window-restore")
            $('#search-bar').hide();
        }
    }

    function hideResult(){
        $('#result').hide();
    }
</script>

</body>
</html>